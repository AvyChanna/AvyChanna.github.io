<!doctype html><html lang=en><head><title>Prism.js Test :: Bits & Pieces â€”
Shower Thoughts on maths and programming</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Code syntax highlighting test"><meta name=keywords content="mathematics,programming,algorithms,number theory,cryptography,modular arithmetic"><meta name=robots content="noodp"><link rel=canonical href=/posts/prismjs-test/><link rel=stylesheet type=text/css href=/css/style.css><link rel=stylesheet type=text/css href=/css/katex.css><link rel=apple-touch-icon-precomposed sizes=57x57 href=/favicon/apple-icon-57x57.png><link rel=apple-touch-icon-precomposed sizes=60x60 href=/favicon/apple-icon-60x60.png><link rel=apple-touch-icon-precomposed sizes=72x72 href=/favicon/apple-icon-72x72.png><link rel=apple-touch-icon-precomposed sizes=76x76 href=/favicon/apple-icon-76x76.png><link rel=apple-touch-icon-precomposed sizes=114x114 href=/favicon/apple-icon-114x114.png><link rel=apple-touch-icon-precomposed sizes=120x120 href=/favicon/apple-icon-120x120.png><link rel=apple-touch-icon-precomposed sizes=144x144 href=/favicon/apple-icon-144x144.png><link rel=apple-touch-icon-precomposed sizes=152x152 href=/favicon/apple-icon-152x152.png><link rel=apple-touch-icon-precomposed sizes=180x180 href=/favicon/apple-icon-180x180.png><link rel=icon type=image/png sizes=16x16 href=/favicon/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=/favicon/favicon-32x32.png><link rel=icon type=image/png sizes=96x96 href=/favicon/favicon-96x96.png><link rel=icon type=image/png sizes=128x128 href=/favicon/favicon-128.png><link rel=icon type=image/png sizes=192x192 href=/favicon/android-icon-192x192.png><link rel=icon type=image/png sizes=196x196 href=/favicon/favicon-196x196.png><link rel=manifest href=/favicon/manifest.json><link rel="shortcut icon" href=/favicon/favicon.ico><meta name=application-name content="Bits & Pieces"><meta name=msapplication-square150x150logo content="/favicon/mstile-150x150.png"><meta name=msapplication-square310x310logo content="/favicon/mstile-310x310.png"><meta name=msapplication-square70x70logo content="/favicon/mstile-70x70.png"><meta name=msapplication-TileColor content="#ee72f1"><meta name=msapplication-TileImage content="/favicon/mstile-144x144.png"><meta name=msapplication-wide310x150logo content="/favicon/mstile-310x150.png"><meta name=theme-color content="#ee72f1"><link rel=preconnect href=/><link rel=preload as=font href=/fonts/woff2/FiraCode-Regular.woff2 type=font/woff2 crossorigin=anonymous><link rel=preload as=font href=/fonts/woff2/FiraCode-Bold.woff2 type=font/woff2 crossorigin=anonymous><link rel=dns-prefetch href=/><meta http-equiv=cache-control content="max-age=31536000"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="Prism.js Test :: Bits & Pieces"><meta property="og:description" content="Code syntax highlighting test"><meta property="og:url" content="/posts/prismjs-test/"><meta property="og:site_name" content="Prism.js Test"><meta property="og:image" content="/favicon/favicon.ico"><meta property="article:published_time" content="2020-05-22 20:29:38 +0530 IST"><link href=/posts/prismjs-test/index.xml rel=alternate type=application/rss+xml title="Bits & Pieces"></head><body><div class=page-wrap><div class="container full center headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>Bits & Pieces</div></a></div><div class="menu-trigger noselect">menu</div></div><nav class=menu><ul class="menu__inner menu__inner--desktop"><li><a href=/>Home</a></li><li><a href=/tags>Tags</a></li><li><a href=/about>About</a></li></ul><ul class="menu__inner menu__inner--mobile"><li><a href=/>Home</a></li><li><a href=/tags>Tags</a></li><li><a href=/about>About</a></li></ul></nav></header><div class=content><div class=post><h1 class=post-title><a href=/posts/prismjs-test/>Prism.js Test</a></h1><div class=post-meta><span class=post-date>Friday 05 May, 2020</span></div><span class=post-tags>#<a href=/tags/python/>python</a>&nbsp;</span><div class=post-content><div><p>Sample AES code</p><pre class="language-python line-numbers diff-highlight" data-start=1><code class="language-python diff-highlight"># Pycryptodome
from functools import reduce
from getpass import getpass

from Crypto.Cipher import AES
from Crypto.Util.Padding import pad, unpad
decode = input(&#34;Encode/Decode? [E/d]&#34;).lower().startswith(&#39;d&#39;)
key = getpass(&#34;KEY=&#34;).encode(&#34;latin-1&#34;)
key = pad(key, 32)
if len(key) &gt; 32:
    key_lst = []
    for i in range(0, len(key), 32):
        key_lst.append(key[i:i &#43; 32])
    key_new = map(lambda x: int(x.hex(), 16), key_lst)
    key = reduce(lambda x, y: x ^ y, key_new).to_bytes(32, &#39;big&#39;)

assert len(key) == 32
if decode:
    buffer = bytes.fromhex(input(&#34;CIPHERTEXT=&#34;))
    cipher = AES.new(key, AES.MODE_EAX, b&#39;0123456789abcdef&#39;)
    print(f&#34;Plaintext = {cipher.decrypt(buffer).decode(&#39;latin-1&#39;)}&#34;)
else:
    buffer = input(&#34;PLAINTEXT=&#34;).encode(&#34;latin-1&#34;)
    buffer = pad(buffer, 32)
    cipher = AES.new(key, AES.MODE_EAX, b&#39;0123456789abcdef&#39;)
    print(f&#34;ciphertext = {cipher.encrypt(buffer).hex()} , Keep it safe&#34;)
</code></pre></div></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><span class="button previous"><a href=/posts/number-theory-primer/><span class=button__icon>&#8592;</span>
<span class=button__text>Number Theory Primer</span></a></span>
<span class="button next"><a href=/posts/test/><span class=button__text>Test Post</span>
<span class=button__icon>&#8594;</span></a></span></div></div></div></div></div></div><footer class=footer><div class=footer__inner><a class=go-to-top href=javascript:void(0); onclick=window.scroll(0,0);>Back to Top</a></div></footer><script async defer src=/js/main.js></script></body></html>